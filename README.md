## JPA를 이용하여 쇼핑몰 API 설계

### 도메인 설계시 주의사항 
- Setter 사용 최소화 (변경 포인트가 많아, 유지 보수 어려움)
- 모든 연관관계는 지연로딩(LAZY)으로 설계 (N+1 문제 해결)
  - N+1 문제란 연관 관계에서 발생하는 이슈로 연관 관계가 설정된 엔티티를 조회할 경우에 조회된 데이터 갯수(n) 만큼 연관관계의 조회 쿼리가 추가로 발생하여 데이터를 읽어오게 되는 문제이다. 
  - 즉시로딩(EAGER)는 예측이 어렵고, 어떤 SQL이 실행되는지 예측하기 매우 어려움
- 컬렉션은 필드에서 바로 초기화
- 외래키가 있는 곳을 연관관계의 주인으로 정한다.
- @ManyToMany 매핑 + @JoinTable 사용을 하게 되면 요구사항에 따라 테이블의 구조 자체가 변경해야 하는 문제가 생긴다. 이를 해결하기 위해 @ManyToOne, @OneToMany 적용
- Entity에는 비즈니스 로직만 존재, 그 외의 화면이나 다른 로직은 없어야 한다.
- 준영속 엔티티를 수정할 때, 변경감지(영속성 컨텍스트에서 엔티티 조회 -> flush), 병합 두 가지 요소 중 변경 감지(dirty Checking) 적용 => 변경 감지 기능을 적용하면 병합과 다르게 원하는 속성만 수정할 수 있고 반대로 병합시킬 때 값이 없으면 null로 업데이트할 위험이 있다.(병합은 모든 필드를 교체)
### 기능 구현 목록
- 회원 기능
  - 회원 등록, 조회
- 상품 기능
  - 상품 등록, 수정, 조회
- 주문 기능
  - 상품 주문, 주문 내역 조회, 주문 취소
  - 
### Architecture
<img width="700" alt="스크린샷 2023-02-20 오전 1 43 24" src="https://user-images.githubusercontent.com/88074556/219961909-413a14c2-4c4b-4bb0-beb2-b2eb033150a9.png">

- Controller : 클라이언트(사용자, 프론트엔드)의 요구를 처리, 클라이언트와 직접적으로 통신하며 Service를 이용해서 기능 구현을 담당
- Service : 기능 구현(비즈니스 로직), 트랜잭션 처리
- Repository : JPA 사용하기 위한 계층, DB와 스프링서버를 연결
- domain : DB의 table과 매핑, 테이블 정보를 가공할 때 필요, JPA 사용시 여러 어노테이션을 사용하며, 테이블, 필드, 필드 옵션 등을 설정

